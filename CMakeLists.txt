# Copyright (c) 2019, 2020, 2021 SiKol Ltd.
# 
# Boost Software License - Version 1.0 - August 17th, 2003
# 
# Permission is hereby granted, free of charge, to any person or organization
# obtaining a copy of the software and accompanying documentation covered by
# this license (the "Software") to use, reproduce, display, distribute,
# execute, and transmit the Software, and to prepare derivative works of the
# Software, and to permit third-parties to whom the Software is furnished to
# do so, all subject to the following:
# 
# The copyright notices in the Software and this entire statement, including
# the above license grant, this restriction and the following disclaimer,
# must be included in all copies of the Software, in whole or in part, and
# all derivative works of the Software, unless such copies or derivative
# works are solely in the form of machine-executable object code generated by
# a source language processor.
# 
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
# SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
# FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
# ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
# DEALINGS IN THE SOFTWARE.

cmake_minimum_required(VERSION 3.12)

set(VCPKG_FEATURE_FLAGS, "registries")

enable_testing()

project(sk-config VERSION 1.0.0 LANGUAGES CXX)

option(SK_CONFIG_BUILD_TESTS "Build and run the tests for sk::config (requires Catch2)")

if(SK_CONFIG_BUILD_TESTS)
	find_package(Catch2 CONFIG REQUIRED)
	find_package(Boost REQUIRED)
	find_package(fmt REQUIRED)
	add_subdirectory(tests)
	add_subdirectory(sample)
endif()

add_library(sk-config INTERFACE)

target_sources(sk-config PRIVATE 
	include/sk/config/parser/qstring.hxx
	include/sk/config/parser/identifier.hxx
	include/sk/config/parser/string.hxx
	
	include/sk/config/parser/tuple.hxx
	include/sk/config/parser/numeric.hxx
	include/sk/config/parser/vector.hxx
	include/sk/config/parser/variant.hxx
	include/sk/config/parser/list.hxx
	include/sk/config/parser/deque.hxx
	include/sk/config/parser/set.hxx
	include/sk/config/parser/unordered_set.hxx

	include/sk/config/detail/propagate.hxx
	include/sk/config/detail/make_member_parser.hxx
	include/sk/config/detail/error_formatter.hxx
	include/sk/config/detail/parser/vector.hxx
	include/sk/config/detail/parser/comment.hxx
	include/sk/config/detail/rule.hxx

	include/sk/config/parse.hxx
	include/sk/config/error.hxx
	include/sk/config/error_detail.hxx
	include/sk/config/parser_for.hxx
	include/sk/config/config.hxx
	include/sk/config/block.hxx
	include/sk/config/option.hxx
	include/sk/config.hxx
 "include/sk/config/parser_policy.hxx" "include/sk/config/detail/parser/option_terminator.hxx" "include/sk/config/detail/parser/option_separator.hxx")

target_include_directories(sk-config INTERFACE include)
target_compile_features(sk-config INTERFACE cxx_std_20)

install(DIRECTORY "include/sk" TYPE INCLUDE)
